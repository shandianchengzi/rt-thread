# FPL011 

## 1. 

- Universal Asynchronous Receiver/Transmitter)UARTUART

- FT2000-4/D2000/E2000

- MIOuart
## 2. 

- 1.  
  2. 
  3. fifo
  4. 


```
fpl011
     fpl011.c
     fpl011.h
     fpl011_g.c
     fpl011_hw.c
     fpl011_hw.h
     fpl011_intr.c
     fpl011_options.c
     fpl011_sinit.c
```


## 3. 

### 

#### 

FPl011SetDataFormat()FPl011FormatFPl011Format

```
FPl011Format format = 
{
    u32 baudrate  = 115200;      /* In bps, ie 1200 */
    u32 data_bits = FPL011_FORMAT_WORDLENGTH_8BIT ;     /* Number of data bits */
    u32 parity    = FPL011_FORMAT_NO_PARITY ;        /* Parity */
    u8  stopbits  = FPL011_FORMAT_1_STOP_BIT ;      /* Number of stop bits */
};

FPl011SetDataFormat(&uart,&format);

```

#### Running UART Communication

- Transmitting ,,buffer

```
u8 buffer_p[10] ;
u32 len = 0 ;
len = FPl011Send(&uart,buffer_p,sizeof(buffer_p)) ;
```

- Receiving ,,buffer

```
u8 buffer_p[10] ;
u32 len = 0 ;
len = FPl011Receive(&uart,buffer_p,sizeof(buffer_p)) ;
```

## 4 

baremetal/example/uart_test

## 4. API

## FPl011Config *FPl011LookupConfig(u32 instance_id)

FPl011  
Initializes a specific FPl011 instance such that it is ready to be used.

- 
instance_id 


- Parameters

instance_id  contains the ID of the device

- 

FPl011Config *NULL 


- Return

FPl011Config *A pointer to the configuration structure or NULL if the specified device is not in the system.


## u32 FPl011Send(FPl011 *uart_p, u8 *byte_p, u32 length)

  

This functions sends the specified buffer using the device in either
 polled or interrupt driven mode.


- 

uart_p FPl011
byte_p  
length FIFO  

- Parameters 
uart_p  is a pointer to the FPl011 instance.
byte_p  is pointer to a buffer of data to be sent.
length  contains the number of bytes to be sent. Any data that was already put into the transmit FIFO will be sent.

- 




- Return

The number of bytes actually sent.

## u32 FPl011Receive(FPl011 *uart_p, u8 *byte_p, u32 length)



This function attempts to receive a specified number of bytes of data from the device and store it into the specified buffer.

- 

uart_p FPl011  
byte_p   
length   

- Parameters 

uart_p is a pointer to the FPl011 instance
byte_p is pointer to buffer for data to be received into
length is the number of bytes to be received. 

- 



- Return

The number of bytes received.


## void FPl011ProgramCtlReg(FPl011 *uart_p,u32 ctrl_reg)

 This function reprograms the control register according to the following
 sequence mentioned in the TRM

- 
uart_p FPl011  
ctrl_reg 

 - Parameters 

uart_p is a pointer to the FPl011 instance
ctrl_reg value to be written



## void FPl011SetOperMode(FPl011 *uart_p,u8 operation_mode)

UART UART  : 

This function sets the operational mode of the UART. The UART can operate
 in one of four modes: Normal, Local Loopback.

- 

uart_pFPl011

operation modeUART

- Parameters 

 uart_p is a pointer to the FPl011 instance.

 operation_mode is the mode of the UART.

## void FPl011SetSpecificOptions(FPl011 *uart_p, u32 options)

  

Sets the options for the specified driver instance. 

- Parameters 

uart_pFPl011

uart_p is a pointer to the FPl011 instance.

options contains the options to be set which are bit masks contained in the file FPl011_uart.h and named FUART_OPTION_*.


## void FPl011ClearSpecificOptions(FPl011 *uart_p, u32 options)


  

Clear the options for the specified driver instance. 

- 

uart_pfpl011

options FPl011_uart.hFUART_OPTION_*  

- Parameters

uart_p is a pointer to the fpl011 instance.

options contains the options to be set which are bit masks contained in the file FPl011_uart.h and named FUART_OPTION_*.

## FError FPl011SetBaudRate(FPl011 *uart_p, u32 baudrate)



Sets the baud rate for the device.

- 

uart pFPl011

BaudRate 

- Parameters

uart_p is a pointer to the FPl011 instance

BaudRate to be set

- 

FT_SUCCESS  

FPL011_ERROR_PARAM

- Return

  FT_SUCCESS if everything configured as expected

  FPL011_ERROR_PARAM if the requested rate is not available
  because there was too much error

## void FPl011GetDataFormat(FPl011 *uart_p,FPl011Format *format_p) 

UART

Gets the data format for the specified UART. 

- 

uart_p fpl011

format_p 

- Parameters

uart_p    is a pointer to the fpl011 instance.

format_p  is a pointer to a format structure that will contain the data format after this call completes.

## FError FPl011SetDataFormat(FPl011 *uart_p,FPl011Format *format_p)



Sets the data format for the specified UART. 

- 

Uart_p fpl011

format_p  

- Parameters

uart_p    is a pointer to the fpl011 instance.

format_p  is a pointer to a format structure that will contain the data format after this call completes.

- 

  FT_SUCCESS  
  FPL011_ERROR_PARAM

- Return

  FT_SUCCESS if everything configured as expected
  FPL011_ERROR_PARAM if one of the parameters was not valid.


## void FPl011SetTxFifoThreadHold(FPl011 *uart_p, u8 trigger_level)

Tx FIFO'TriggerLevel'

This functions sets the Tx FIFO trigger level to the 'TriggerLevel' argument.

- 

uart_p fpl011
Trigger_level 0-32 (FPL011IFLS_TXIFLSEL_1_8 - FPL011IFLS_TXIFLSEL_7_8)  


- Parameters

uart_p is a pointer to the fpl011 instance.

trigger_level contains the trigger level to set. This is a value from 0-32  (FPL011IFLS_TXIFLSEL_1_8 - FPL011IFLS_TXIFLSEL_7_8)


## void FPl011SetRxFifoThreadhold(FPl011 *uart_p, u8 trigger_level)

Rx FIFO'TriggerLevel'  

This functions sets the Rx FIFO trigger level to the 'TriggerLevel' argument.

- 

uart_p fpl011
Trigger_level 0-32 (FPL011IFLS_RXIFLSEL_1_8 - FPL011IFLS_RXIFLSEL_7_8)  

- Parameters

uart_p is a pointer to the fpl011 instance.

trigger_level contains the trigger level to set. This is a value from 0-32  (FPL011IFLS_RXIFLSEL_1_8 - FPL011IFLS_RXIFLSEL_7_8)

## u32 FPl011GetInterruptMask(FPl011 *uart_p)



This function gets the interrupt mask.

- 

uart_pPFl011

- Parameters

uart_p is a pointer to the PFl011 instance


## void FPl011SetInterruptMask(FPl011 *uart_p, u32 mask)



This function sets the interrupt mask.

- 

uart_pPFl011

mask '1''0'  

- Parameters

uart_p is a pointer to the PFl011 instance

mask contains the interrupts to be enabled or disabled. A '1' enables an interrupt, and a '0' disables.
